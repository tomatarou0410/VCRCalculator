<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>電圧・電流・抵抗 計算器</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Hiragino Kaku Gothic ProN",Meiryo,sans-serif;background:#f7f7fb;color:#111;padding:24px}
    .card{max-width:560px;margin:18px auto;padding:18px;background:#fff;border-radius:12px;box-shadow:0 6px 18px rgba(20,30,60,0.08)}
    h1{font-size:20px;margin:0 0 12px}
    .row{display:flex;gap:8px;align-items:center;margin:8px 0}
    label{min-width:80px}
    input[type="number"]{flex:1;padding:8px;border-radius:8px;border:1px solid #ddd}
    select{padding:7px;border-radius:8px;border:1px solid #ddd}
    .btn{display:inline-block;padding:8px 12px;border-radius:8px;background:#2563eb;color:#fff;border:none;cursor:pointer}
    .btn:active{transform:translateY(1px)}
    .note{font-size:13px;color:#555;margin-top:8px}
    .result{margin-top:14px;padding:12px;background:#f1f5f9;border-radius:8px}
    .error{color:#b91c1c}
    footer{font-size:12px;color:#666;margin-top:14px}
  </style>
</head>
<body>
  <div class="card">
    <h1>電圧・電流・抵抗 計算器 (オームの法則)</h1>
    <p class="note">2つの値を入力すると、残りの1つと電力(ｗ)を計算します。電流は A / mA を切り替えられます。3つの値を入力した場合、それが正しいかを判定します</p>

    <div class="row">
      <label for="v">電圧 V</label>
      <input id="v" type="number" step="any" placeholder="例: 1.5">
    </div>

    <div class="row">
      <label for="i">電流</label>
      <input id="i" type="number" step="any" placeholder="例: 200">
      <select id="iUnit">
        <option value="A">A</option>
        <option value="mA">mA</option>
      </select>
    </div>

    <div class="row">
      <label for="r">抵抗 Ω</label>
      <input id="r" type="number" step="any" placeholder="例: 7.5">
    </div>

    <div style="display:flex;gap:8px;margin-top:10px">
      <button id="calc" class="btn">計算</button>
      <button id="clear" class="btn" style="background:#9ca3af">クリア</button>
    </div>

    <div id="out" class="result" aria-live="polite"></div>
    <div id="err" class="note error" aria-live="assertive"></div>

    <footer>オームの法則: V = I × R （電圧 = 電流 × 抵抗）</footer>
  </div>

  <script>
    const elV = document.getElementById('v');
    const elI = document.getElementById('i');
    const elR = document.getElementById('r');
    const unit = document.getElementById('iUnit');
    const out = document.getElementById('out');
    const err = document.getElementById('err');
    const calc = document.getElementById('calc');
    const clearBtn = document.getElementById('clear');

    function isFilled(el){ return el.value !== '' && !isNaN(Number(el.value)); }
    function toNum(el){ return Number(el.value); }

    function getCurrentInAmp(){
      let val = toNum(elI);
      if(unit.value === 'mA') return val / 1000;
      return val;
    }

    function formatNumber(x){ if (!isFinite(x)) return String(x); return parseFloat(x.toFixed(10)).toString(); }

    calc.addEventListener('click', ()=>{
      err.textContent = '';
      out.textContent = '';

      const hasV = isFilled(elV);
      const hasI = isFilled(elI);
      const hasR = isFilled(elR);
      const count = [hasV,hasI,hasR].filter(Boolean).length;

      if (count === 3){
        const V = toNum(elV);
        const I = getCurrentInAmp();
        const R = toNum(elR);
        const ok = Math.abs(V - I * R) < 1e-6;
        out.innerHTML = ok ? '<strong>式は正しいです。</strong>' : '<strong>式が成り立っていません。</strong>';
        return;
      }

      if (count < 2){ err.textContent = '2つの値を入力してください。'; return; }
      if (count > 2){ err.textContent = '2つだけ入力してください。'; return; }

      try{
        let V,I,R;
        let resultHTML = '';

        if (!hasV){
          I = getCurrentInAmp();
          R = toNum(elR);
          if (R === 0){ err.textContent = '抵抗0Ωは計算不可。'; return; }
          V = I * R;
          resultHTML += `<strong>計算結果：</strong> V = ${formatNumber(V)} V`;

        } else if (!hasI){
          V = toNum(elV);
          R = toNum(elR);
          if (R === 0){ err.textContent = '抵抗0Ωは計算不可。'; return; }
          I = V / R;
          let disp = I;
          let unitOut = 'A';
          if(unit.value === 'mA'){ disp = I * 1000; unitOut = 'mA'; }
          resultHTML += `<strong>計算結果：</strong> I = ${formatNumber(disp)} ${unitOut}`;

        } else if (!hasR){
          V = toNum(elV);
          I = getCurrentInAmp();
          if (I === 0){ err.textContent = '電流0Aは計算不可。'; return; }
          R = V / I;
          resultHTML += `<strong>計算結果：</strong> R = ${formatNumber(R)} Ω`;
        }

        if (isFinite(V) && isFinite(I)){
          const P = V * I;
          resultHTML += `<br>電力: ${formatNumber(P)} W`;
        }

        out.innerHTML = resultHTML;

      }catch(e){ err.textContent = '計算エラー。入力を確認してください。'; }
    });

    clearBtn.addEventListener('click', ()=>{
      elV.value = '';
      elI.value = '';
      elR.value = '';
      out.textContent = '';
      err.textContent = '';
    });
  </script>
</body>
</html>
